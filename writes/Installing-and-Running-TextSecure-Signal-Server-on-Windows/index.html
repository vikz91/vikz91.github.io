<!DOCTYPE html>
<html>
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.2.6 -->

    <!-- Title -->
    
    <title>
        
            Installing and Running TextSecure (Signal) Server on Windows | 
        
        Abhishek Deb
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Abhishek Deb">
    <meta name="description" content="Sr. Developer @ Plexus 365">
    <meta name="keywords" content="null">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Abhishek Deb">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://debabhishek.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Installing and Running TextSecure (Signal) Server on Windows | Abhishek Deb">
    <meta property="og:description" content="Sr. Developer @ Plexus 365">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
    body, html {
        font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",Arial, sans-serif;
    }

    a {
        color: #00838F;
    }

    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important;
    }

    /* Sidebar User Drop Down Menu Text Color */
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
        color: #0097A7 !important;
    }

    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
        color: #0097A7 !important;
    }

    .toTop {
        background: #757575 !important;
    }

    .material-layout .material-post>.material-nav,
    .material-layout .material-index>.material-nav,
    .material-nav a {
        color: #757575;
    }

    #scheme-Paradox .MD-burger-layer {
        background-color: #757575;
    }

    #scheme-Paradox #post-toc-trigger-btn {
        color: #757575;
    }

    .post-toc a:hover {
        color: #00838F;
        text-decoration: underline;
    }
</style>


<!-- Theme Background Related-->

    <style>
        body {
            background-color: #F5F5F5;
        }

        /* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
            background-color: #fff;
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
            setTimeout(function () {
                document.body.background="https://api.i-meto.com/bing?C";
            }, 2000);
        }
    </script>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>


    <script src="/js/jquery.min.js"></script>

    <link rel="stylesheet" href="/css/highlight/solarized-white.css">

    <!-- UC Browser Compatible-->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write('<link rel="stylesheet" href="/css/uc.css">');
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Installing-and-Running-TextSecure-Signal-Server-on-Windows"><span class="post-toc-number">1.</span> <span class="post-toc-text">Installing and Running TextSecure (Signal) Server on Windows</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Meta"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Meta</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#About"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">About</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Prerequisites"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Prerequisites</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Building-and-Compiling"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Building and Compiling</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Creating-Config-files"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">Creating Config files</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pushserver-yml"><span class="post-toc-number">1.5.1.</span> <span class="post-toc-text">pushserver.yml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#textsecure-yml"><span class="post-toc-number">1.5.2.</span> <span class="post-toc-text">textsecure.yml</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Disabling-iOS-Features-Temporarily"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">Disabling iOS Features ( Temporarily)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Configuring-amp-Running-Database"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">Configuring & Running Database</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Postgresql"><span class="post-toc-number">1.7.1.</span> <span class="post-toc-text">Postgresql</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis"><span class="post-toc-number">1.7.2.</span> <span class="post-toc-text">Redis</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Running-Everything-Together"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">Running Everything Together</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Testing-with-Android-App"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">Testing with Android App</span></a></li></ol></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
</script>

        
    
            <p class="article-headline-p">
                Installing and Running TextSecure (Signal) Server on Windows
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/images/AbhishekDeb.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Abhishek Deb</strong>
        <span>Feb 01, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Data-Security/">Data Security</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/Encryption/">Encryption</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/Security/">Security</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/end-to-end/">end to end</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Installing and Running TextSecure (Signal) Server on Windows&url=http://debabhishek.com//writes/Installing-and-Running-TextSecure-Signal-Server-on-Windows/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Installing and Running TextSecure (Signal) Server on Windows&url=http://debabhishek.com//writes/Installing-and-Running-TextSecure-Signal-Server-on-Windows/index.html&via=Abhishek Deb" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://debabhishek.com//writes/Installing-and-Running-TextSecure-Signal-Server-on-Windows/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://debabhishek.com//writes/Installing-and-Running-TextSecure-Signal-Server-on-Windows/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="Installing-and-Running-TextSecure-Signal-Server-on-Windows"><a href="#Installing-and-Running-TextSecure-Signal-Server-on-Windows" class="headerlink" title="Installing and Running TextSecure (Signal) Server on Windows"></a>Installing and Running TextSecure (Signal) Server on Windows</h1><p>While working at <a href="http://plexus365.com/" target="_blank" rel="external">Plexus</a>, I had to implement Signal Server’s end to end encryption on certain project. Though Open Whisper System had the code in <a href="https://github.com/WhisperSystems/Signal-Server" target="_blank" rel="external">github</a>, the instructions were quite unclear on installing the server on local machine. I stumbled upon few Github posts and got this amazing guide. So this is my take on installing TextSecure (Signal) Server on a local Windows 10 machine. </p>
<a id="more"></a>
<h2 id="Meta"><a href="#Meta" class="headerlink" title="Meta"></a>Meta</h2><ul>
<li>Author: Abhishek Deb(vikz91.deb@gmail.com, abhishek@plexus365.com)  </li>
<li>Date: 1st Feb 2017</li>
<li>Source:  <a href="https://github.com/WhisperSystems/Signal-Server" target="_blank" rel="external">WhisperSystems</a> <a href="https://github.com/lucaconte/BeatTheMeddler" target="_blank" rel="external">Lucaconte</a>.  </li>
</ul>
<h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>If you are using Whatsapp then you must have seen “end-to-end” encryption thingy! Well, After Apple’s beef with FBI, Whatsapp just <a href="https://www.wired.com/2016/04/forget-apple-vs-fbi-whatsapp-just-switched-encryption-billion-people/" target="_blank" rel="external">turned on encryption for a billion people</a>.</p>
<p><img src="https://www.securebeam.com/images/whatsapp-end-to-end/whatsapp_end_to_end.jpg" alt="Whatsapp End-to-end security"><br><em>(Image Courtesy : <a href="https://www.securebeam.com/whatsapp-end-to-end" target="_blank" rel="external">SecureBeam</a>)</em></p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li>Java 1.7.</li>
<li>Windows 10</li>
<li>Redis (for caching purposes)</li>
<li>PostgreSQL instance</li>
<li>Twillio account for SMS registration process confirmation</li>
<li>Amazon AWS S3 bucket service for messages’ attachments</li>
<li>A GCM account from google developer console: a senderId add a ApiKey. Create a project, senderId is the projectNumber. For ApiKey, go to API management -&gt; credentials -&gt; create credentials -&gt; API Keys -&gt; Server Key and save this key</li>
<li>APN account for Apple Push Notifications (two pem certificates) [ask]</li>
</ul>
<h2 id="Building-and-Compiling"><a href="#Building-and-Compiling" class="headerlink" title="Building and Compiling"></a>Building and Compiling</h2><ol>
<li>Clone TextSecure (Signal) Server<br><code>git clone https://github.com/lucaconte/Signal-Server.git</code></li>
<li>Clone Push Server<br><code>git clone https://github.com/lucaconte/PushServer.git</code></li>
<li>Clone WebSocket Resources<br><code>git clone https://github.com/lucaconte/WebSocket-Resources.git</code></li>
<li>In Push Server pom.xml, change <code>capsule.maven.plugin.version</code> version to <code>1.0.1</code></li>
<li>Build Push Server  (from inside this folder)<br><code>mvn clean install</code></li>
<li>Download &amp; install gpg4win gpg tool for signing)<br><code>https://www.gpg4win.org/download.html : https://files.gpg4win.org/gpg4win-vanilla-2.3.3.exe</code></li>
<li>Make sure Environment Variables are set for gpg<br><code>GNUPGHOME : c:\Users\&lt;username&gt;\AppData\Roaming\gnupg //or whatever path it is</code>  </li>
<li>Create default <code>secring</code> and <code>pubring</code> by opening gpg2.exe file from installed location</li>
<li>Exit the opened terminal which says “type message”</li>
<li>Build Push Websocket-Resource (from inside thsi folder)<br><code>mvn clean install</code></li>
<li>The build will fail at javadoc signing but its okay as we have got the main binary in target folder (websocket-resources-0.4.1)</li>
<li>Link this file in maven repo ( make sure the versions are same in the file and in teh command)<br><code>mvn install:install-file -Dfile=./library/target/websocket-resources-0.4.1.jar -DgroupId=org.whispersystems -DartifactId=websocket-resources -Dversion=0.4.1 -Dpackaging=jar</code></li>
<li>Now build the Signal Server  (from inside the Signal Server folder)<br><code>mvn clean install -DskipTests</code></li>
<li>We skip the tests because they will fail for not finding a key which we will cover later</li>
</ol>
<h2 id="Creating-Config-files"><a href="#Creating-Config-files" class="headerlink" title="Creating Config files"></a>Creating Config files</h2><h3 id="pushserver-yml"><a href="#pushserver-yml" class="headerlink" title="pushserver.yml"></a>pushserver.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="attr">redis:</span></div><div class="line"><span class="attr">  url:</span> redis://localhost:<span class="number">6379</span>/<span class="number">2</span></div><div class="line"></div><div class="line"><span class="attr">authentication:</span></div><div class="line"><span class="attr">  servers:</span></div><div class="line"><span class="bullet">    -</span></div><div class="line"><span class="attr">      name:</span> <span class="number">123</span></div><div class="line"><span class="attr">      password:</span> <span class="number">123</span></div><div class="line"><span class="attr">gcm:</span></div><div class="line"><span class="attr">  xmpp:</span> <span class="literal">false</span></div><div class="line"><span class="attr">  apiKey:</span> &lt;INPUT HERE<span class="string">&gt;</span></div><div class="line"><span class="attr">  senderId:</span> &lt;INPUT HERE<span class="string">&gt;</span></div><div class="line"><span class="attr">  redphoneApiKey:</span> AIddSyAsviyMy8jKe8chCEfr8NbeqGghy7oOCi4 <span class="comment">#fake</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="attr">apn:</span></div><div class="line"><span class="attr">  feedback:</span> <span class="literal">false</span></div><div class="line"><span class="attr">  pushKey:</span> /path/to/your/apnpushcertificates/apns-dev-key-noenc.pem <span class="comment">#fake</span></div><div class="line"><span class="attr">  voipKey:</span> /path/to/your/apnpushcertificates/apns-dev-key-noenc.pem <span class="comment">#fake</span></div><div class="line"><span class="attr">  voipCertificate:</span> /path/to/your/apnpushcertificates/apns-dev-cert.pem <span class="comment">#fake</span></div><div class="line"><span class="attr">  pushCertificate:</span> /path/to/your/apnpushcertificates/apns-dev-cert.pem <span class="comment">#fake</span></div><div class="line"></div><div class="line"><span class="attr">server:</span></div><div class="line"><span class="attr">    applicationConnectors:</span></div><div class="line"><span class="attr">    - type:</span> http</div><div class="line"><span class="attr">      port:</span> <span class="number">9090</span></div><div class="line"><span class="attr">    adminConnectors:</span></div><div class="line"><span class="attr">    - type:</span> http</div><div class="line"><span class="attr">      port:</span> <span class="number">9091</span></div><div class="line"><span class="attr">    gzip:</span></div><div class="line"><span class="attr">        enabled:</span> <span class="literal">true</span></div><div class="line"></div><div class="line"><span class="attr">logging:</span></div><div class="line"><span class="attr">  level:</span> INFO</div><div class="line"><span class="attr">  appenders:</span></div><div class="line"><span class="attr">    - type:</span> file</div><div class="line"><span class="attr">      currentLogFilename:</span> /tmp/pushserver.log</div><div class="line"><span class="attr">      archivedLogFilenamePattern:</span> /tmp/pushserver-%d.log.gz</div><div class="line"><span class="attr">      archivedFileCount:</span> <span class="number">5</span></div><div class="line"><span class="attr">    - type:</span> console</div></pre></td></tr></table></figure>
<h3 id="textsecure-yml"><a href="#textsecure-yml" class="headerlink" title="textsecure.yml"></a>textsecure.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># This is the sample config/textsecure.yml file for the TextSecure Server</span></div><div class="line"><span class="comment"># Pay attention! To start TextSecur server you will need to install and start PushServer</span></div><div class="line"></div><div class="line"><span class="attr">twilio:</span></div><div class="line"><span class="attr">  accountId:</span> &lt;INPUT HERE<span class="string">&gt;</span></div><div class="line"><span class="attr">  accountToken:</span> &lt;INPUT HERE<span class="string">&gt;</span></div><div class="line"><span class="attr">  numbers:</span></div><div class="line"><span class="bullet">    -</span></div><div class="line">      +<span class="number">33756796138</span> <span class="comment">#fake</span></div><div class="line"><span class="attr">  localDomain:</span> foo.org</div><div class="line"></div><div class="line"><span class="attr">push:</span></div><div class="line"><span class="attr">  host:</span> localhost</div><div class="line"><span class="attr">  port:</span> <span class="number">9090</span></div><div class="line"><span class="attr">  username:</span> <span class="number">123</span></div><div class="line"><span class="attr">  password:</span> <span class="number">123</span></div><div class="line"></div><div class="line"><span class="attr">s3:</span></div><div class="line"><span class="attr">   accessKey:</span> ABCDEFGCUFYDHVM2LXXX <span class="comment">#fake</span></div><div class="line"><span class="attr">   accessSecret:</span> W0UfGDddfAbqYyCTIIbSQlDtreTGokOs0OTpL0SE <span class="comment">#fake</span></div><div class="line"><span class="attr">   attachmentsBucket:</span> thenameofyouts3buket <span class="comment">#fake</span></div><div class="line"></div><div class="line"><span class="attr">directory:</span></div><div class="line"><span class="attr">  url:</span> <span class="string">"redis://localhost:6379/0"</span></div><div class="line"></div><div class="line"><span class="attr">cache:</span></div><div class="line"><span class="attr">  url:</span> <span class="string">"redis://localhost:6379/1"</span></div><div class="line"></div><div class="line"><span class="attr">server:</span></div><div class="line"><span class="attr">  applicationConnectors:</span></div><div class="line"><span class="attr">    - type:</span> http</div><div class="line"><span class="attr">      port:</span> <span class="number">8080</span></div><div class="line">      <span class="comment">#keyStorePath: config/example.keystore</span></div><div class="line">      <span class="comment">#keyStorePassword: example</span></div><div class="line">      <span class="comment">#validateCerts: true</span></div><div class="line"><span class="attr">  adminConnectors:</span></div><div class="line"><span class="attr">    - type:</span> http</div><div class="line"><span class="attr">      port:</span> <span class="number">8081</span></div><div class="line">      <span class="comment">#keyStorePath: config/example.keystore</span></div><div class="line">      <span class="comment">#keyStorePassword: example</span></div><div class="line">      <span class="comment">#validateCerts: true</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="attr">websocket:</span></div><div class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></div><div class="line"></div><div class="line"><span class="attr">messageStore:</span> <span class="comment"># Postgres database configuration for message store</span></div><div class="line"><span class="attr">  driverClass:</span> org.postgresql.Driver</div><div class="line"><span class="attr">  user:</span> <span class="string">"postgres"</span></div><div class="line"><span class="attr">  password:</span> <span class="string">"postgres"</span></div><div class="line"><span class="attr">  url:</span> <span class="string">"jdbc:postgresql://localhost:5432/messagedb"</span></div><div class="line"></div><div class="line"><span class="attr">database:</span></div><div class="line"><span class="attr">  driverClass:</span> org.postgresql.Driver</div><div class="line"><span class="attr">  user:</span> <span class="string">"postgres"</span></div><div class="line"><span class="attr">  password:</span> <span class="string">"postgres"</span></div><div class="line"><span class="attr">  url:</span> <span class="string">"jdbc:postgresql://localhost:5432/accountsdb"</span></div><div class="line"><span class="attr">  properties:</span></div><div class="line"><span class="attr">    charSet:</span> UTF<span class="bullet">-8</span></div><div class="line"></div><div class="line"><span class="comment">#federation: # is disabled</span></div><div class="line"></div><div class="line"><span class="attr">logging:</span></div><div class="line"><span class="attr">  level:</span> INFO</div><div class="line"><span class="attr">  appenders:</span></div><div class="line"><span class="attr">    - type:</span> file</div><div class="line"><span class="attr">      currentLogFilename:</span> /tmp/textsecureshserver.log</div><div class="line"><span class="attr">      archivedLogFilenamePattern:</span> /temp/textsecureserver-%d.log.gz</div><div class="line"><span class="attr">      archivedFileCount:</span> <span class="number">5</span></div><div class="line"><span class="attr">    - type:</span> console</div><div class="line"></div><div class="line"></div><div class="line"><span class="attr">redphone:</span></div><div class="line"><span class="attr">  authKey:</span> <span class="number">1234567890</span> <span class="comment">#fake</span></div></pre></td></tr></table></figure>
<p>Place pushserver.yml in Push Server Folder.<br>Place textsecure.yml in Text Sexure /config folder.  </p>
<h2 id="Disabling-iOS-Features-Temporarily"><a href="#Disabling-iOS-Features-Temporarily" class="headerlink" title="Disabling iOS Features ( Temporarily)"></a>Disabling iOS Features ( Temporarily)</h2><p>useful part if you plan to test Android only as first</p>
<ol>
<li><p>Remove @NotEmpty annotation above “private ApnConfiguration apn;” field definition into <code>org.whispersystems.pushserver.PushServerConfiguration</code> class, so into yml PushServers’s file the APN related params become optional.</p>
</li>
<li><p>Into <code>org.whispersystems.pushserver.PushServer</code>‘s “run” method comment every row with apnSender var and pass null in the jersey Controller registration of the PushController:</p>
</li>
</ol>
<p><code>environment.jersey().register(new PushController(null, gcmSender));</code><br>instead of<br><code>environment.jersey().register(new PushController(apnSender, gcmSender));</code><br>Lines : 55, 58 and 62</p>
<h2 id="Configuring-amp-Running-Database"><a href="#Configuring-amp-Running-Database" class="headerlink" title="Configuring &amp; Running Database"></a>Configuring &amp; Running Database</h2><h3 id="Postgresql"><a href="#Postgresql" class="headerlink" title="Postgresql"></a>Postgresql</h3><ol>
<li>Download and Install Postgres<br><code>https://www.postgresql.org/download/windows/</code></li>
<li>Create Databases (Exit all postgres cli instances first)<br><code>createdb -U postgres accountsdb</code><br><code>createdb -U postgres messagedb</code></li>
<li>Import Table Schemas: (from inside Signal-Server folder)<br><code>java -jar target/TextSecureServer-&lt;VERSION&gt;.jar accountdb migrate config/textsecure.yml</code><br><code>java -jar target/TextSecureServer-&lt;VERSION&gt;.jar messagedb migrate config/textsecure.yml</code></li>
</ol>
<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><ol>
<li>Download and Install Redis<br><code>https://github.com/rgl/redis/downloads</code></li>
</ol>
<h2 id="Running-Everything-Together"><a href="#Running-Everything-Together" class="headerlink" title="Running Everything Together"></a>Running Everything Together</h2><ol>
<li>Run Redis<br><code>redis-server</code></li>
<li>Run Push Server<br><code>java -jar Push-Server-&lt;VERSION&gt;-capsule-fat.jar server pushserver.yml</code></li>
<li>Run Text Secure ( Signal) Server<br><code>java -jar target/TextSecureServer-&lt;VERSION&gt;.jar server config/textsecure.yml</code></li>
</ol>
<h2 id="Testing-with-Android-App"><a href="#Testing-with-Android-App" class="headerlink" title="Testing with Android App"></a>Testing with Android App</h2><p>Coming soon …</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    


    <!-- 使用 DISQUS -->
    <div id="disqus-comment">
        <div id="disqus_thread"></div>
<script>
    $('html').ready(function() {
        setTimeout(function() {
            var disqus_config = function () {
                this.page.url = 'http://debabhishek.com/writes/Installing-and-Running-TextSecure-Signal-Server-on-Windows/index.html';  // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//debabhishek-com.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        },1500);
    });
</script>

    </div>
    <style>
        #disqus-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>


                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="//writes/Phonegap-Tutorial-for-a-busy-programmer/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="//writes/Rapid-NodeJS-REST-API-Server-generator-with-generator-restgoose-and-yo/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>
    

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/images/AbhishekDeb.jpg" alt="Abhishek Deb's avatar">

    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        iam@debabhishek.com
        <b class="caret"></b>
    </a>

</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:vikz91.deb@gmail.com" target="_blank" title="Email Me">
                        <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
            Home
        </a>
    </li>


    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">work</i>
             What I do?
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li style="padding-left:10px;"> <i>Sr. Developer @ Plexus 365</i></li>
            <li style="padding-left:10px;"> <i>Author @ yo restgoose</i></li>
        </ul>
    </li>


    <!-- I'm Feeling Lucky -->
    <!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
    -->

    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             Archives
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">June 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">March 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/04/">April 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/03/">March 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/02/">February 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/08/">August 2014<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/07/">July 2014<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/06/">June 2014<span class="sidebar_archives-count">3</span></a>
        </ul>
    </li>

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                Categories
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Data-Security/">Data Security<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Game-Development/">Game Development<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Mobile-App/">Mobile App<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/NodeJS/">NodeJS<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
    

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
  	
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
  	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
            Number of articles
            <span class="sidebar-badge">13</span>
        </a>
    </li>
</ul>


        <!-- Sidebar Divider -->
        <div class="sidebar-divider"></div>

        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        Theme - Material
        <span class="sidebar-badge badge-circle">i</span>
    </div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
    sidebar.help
    <span class="mdl-button__ripple-container">
      <span class="mdl-ripple"></span>
    </span>
  </div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

    </div>

    <!-- Sidebar Sponsor -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/vikz91" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/abhishekdeb" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/+AbhishekDeb" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/vikz91" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    
        <a href="https://www.linkedin.com/in/debabhishek/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-linkedin.png);">
                <span class="visuallyhidden">LinkedIn</span>
            </button><!--
     --></a>
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;Abhishek Deb
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();

    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });

    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    <script src="/js/smoothscroll.js"></script>









    <!-- 使用 DISQUS js 代码 -->
    <script id="dsq-count-scr" src="//debabhishek-com.disqus.com/count.js" async></script>



<!-- Swiftye -->


<!-- Local Search-->

    <script>
    var searchFunc = function(path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: 'xml',
            success: function( xmlResponse ) {
                // get the contents from search data
                var datas = $( 'entry', xmlResponse ).map(function() {
                    return {
                        title: $( 'title', this ).text(),
                        content: $('content',this).text(),
                        url: $( 'url' , this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function() {
                    var str='<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function(data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                        var data_url = data.url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if(data_title != '' && data_content != '') {
                            keywords.forEach(function(keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if( index_title < 0 && index_content < 0 ) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += '<li><a href="'+ data_url +'" class="search-result-title" target="_blank">'+ data_title;
                            var content = data.content.trim().replace(/<[^>]+>/g, '');
                            if (first_occur >= 0) {
                                // cut out characters
                                var start = first_occur - 6;
                                var end = first_occur + 6;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 10;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, 'gi');
                                    match_content = match_content.replace(regS, '<em class="search-keyword">'+keyword+'</em>');
                                })
                                str += '<p class="search-result">' + match_content +'...</p>' +'</a>';
                            }
                        }
                    });
                    $resultContent.innerHTML = str;
                });
            }
        });
    }
</script>


    <script>
        var inputArea = document.querySelector('#search');
        var getSearchFile = function() {
            var path = 'search.xml';
            searchFunc(path, 'search', 'local-search-result');
        }

        if(inputArea) {
            inputArea.onfocus = function() {
                getSearchFile();
            }
        }
    </script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
